<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CTS Map GPS</title>
<style>
  body { font-family: sans-serif; padding: 10px; }
  #map-container { position: relative; width: 100%; max-width: 800px; }
  #cts-map { width: 100%; display: block; }
  #marker {
    position: absolute;
    width: 18px;
    height: 18px;
    background-color: red;
    border-radius: 50%;
    border: 2px solid white;
    transform: translate(-50%, -50%);
    display: none;
    z-index: 10;
  }
</style>
</head>
<body>
<h2>CTS Map 現在位置</h2>
<div id="map-container">
  <img id="cts-map" src="cts.jpg" alt="CTS Map">
  <div id="marker"></div>
</div>

<script>
  // 4隅の座標
  const topLeft     = { lat: 42.791325, lon: 141.698869 }; // 左上
  const bottomRight = { lat: 42.759347, lon: 141.676080 }; // 右下

  function updateMarker(position) {
    const lat = position.coords.latitude;
    const lon = position.coords.longitude;
    const img = document.getElementById("cts-map");
    const marker = document.getElementById("marker");

    const w = img.clientWidth;
    const h = img.clientHeight;

    const x = ((lon - topLeft.lon) / (bottomRight.lon - topLeft.lon)) * w;
    const y = ((lat - topLeft.lat) / (bottomRight.lat - topLeft.lat)) * h;

    marker.style.left = x + "px";
    marker.style.top = y + "px";
    marker.style.display = "block";
  }

  function errorHandler(err) {
    alert("位置情報を取得できません: " + err.message);
  }

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(updateMarker, errorHandler, {
      enableHighAccuracy: true,
      maximumAge: 3000,
      timeout: 10000
    });
  } else {
    alert("このブラウザでは位置情報が利用できません。");
  }
</script>
</body>
</html>
